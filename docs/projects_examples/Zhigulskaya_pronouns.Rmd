---
title: "Initial [n] in the third person pronouns in prepositional constructions in the dialect of Mikhalevskaya village"
author: "Vasilisa Zhigulskaya"
date: '19 June 2017'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

In standard Russian, all third person pronouns in prepositional constructions must have initial [n]. However, in some dialects, it is not the case. Mikhalevskaya village dialect is characterized with forms without the initial [n], which is one of its dialectal features. However, the language of the speakers is becoming standardized and there are less and less occurrences of dialectal forms. The data set used in this project consists of 1015 observations. It includes the following variables. Output variable is absence or presence of the initial [n] (categorical). Input variables are informants’ ID (categorical), their year of birth (numerical), gender (categorical: male or female), education level (categorical) as well as some variables that characterize prepositional constructions: type (categorical) and frequency (numerical) of the preposition, form (categorical) and case (categorical) of the pronoun. Our hypothesis is that sociolinguistic factors (such as age of the informants, their gender and education) might influence the proportion of dialectal forms. The main idea is that the younger the speakers are, the more forms with [n] he/she has. Another (weaker) supposition is that the higher the education level (i.e. the more the contact with the standard variant), again the more cases of the initial [n] we can observe. Other variables will serve as possible predictors, although we do not know in what degree and direction they can influence the absence or presence of [n].

## Description of the Phenomenon

The phenomenon illustrated in this paper is one of the linguistic variables that differs dialect of Mikhalevskaya from the standard language. It was a result of reanalysis of constructions including prepositions *vún* ‘in’, *kún* ‘to’ è *sún* ‘with’ (later expanded to other prepositions) with third person pronouns, which took place very early in the history of Russian. In modern standard Russian, the initial nasal in pronouns is obligatory in most prepositional constructions (primary prepositions), and is optional or even impossible in constructions with some prepositions. Examples of initial [n]: *u n’ego*  ‘by him’, *na n’ix* ‘on them’, *s n’im* ‘with him’. On the contrary, in some Russian dialects, the initial nasal consonant after prepositions had been lost and became a dialectal feature.

## Data Collection and the Data Base
The Ustja River Basin Corpus, that includes data collected in 2013 to 2016 during four field trips to Mikhalevskaya, the village in Ustya district of Arkhangelskaya Oblast, was the source of data this research is based on. It consists of of interviews, transcribed in standard Russian orthography and aligned with original audio (von Waldenfels et al. 2014). The data were collected through CQP-queries as follows: *[lemma="pronoun"] ::match.utterance_spkr="speaker"*. Instead of the word pronoun, a *pronoun* was included (*îí*, *îíà* or *îíè*), and instead of the word *speaker*, the abbreviation of the selected speaker was included (*ïôï1928*, *àâì1922* etc., where part in letters is an abbreviation of speaker’s name and numerical part is their year of birth). For example, the query *[lemma="îí"] ::match.utterance_spkr="ïôï1928"* allows us to find all forms of the pronoun *îí* (singular) that were used by the speaker PFP born in 1928. 
The data includes third person pronouns, singular and plural, in oblique cases both in prepositional (1015 occurrences, 33 informants). Male and neuter pronouns were considered together, because they are not differentiated in the corpus annotation. Each pronominal form was examined for the presence or absence of initial nasal [n]. We did not register the initial sound in pronouns without nasal consonant (i.e. [j] or a vowel, which may itself be another parameter of variation), because there are many cases when determining the quality of the anlaut is very problematic. We only controlled whether the initial nasal [n] is present or not.

```{r}
setwd("C:/Users/Âàñèëèñà/Documents/MA_HSE/R Statistics")
df <- read.csv("pronouns.csv")

```
```{r}
library(tidyverse)
```

We need to check what variables might be relevant for us in the research. They are:

* `speaker` (33 informants),
* `year` (from 1922 to 1996),
* `gender` (`female` or `male`),
* `education` (`low`, `low-mid`, `high-mid`, `high`),
* `preposition` (25 prepositions),
* `prep_type` (`initial`, i.e. *â*, *ê* and *ñ* and `later`, i.e. other prepositions) 
* `case` and `form` (case and number / gender form of pronoun)
* as well as of course `consonant` (`no` and `yes`).

```{r}
summary(df)
str(df)
```

In order to see whether the frequency of the preposition has any influence on the pronunciation of the following pronoun, we need to calculate and add this information. For that, we create a separate table with frequencies and then add them in a column to the data frame with the help of `inner_join` (it is a numerical variable):

```{r}
df %>%
  group_by(preposition) %>%
  summarise(prep_frequency = n()/1015) ->
  df_freq
df <- inner_join(df, df_freq)
```


## Descriptive Statistics

To begin with, we want to visualize the correlation between the year of birth and the absence or presence of [n]. For first, we will not differentiate between the speakers in order to see the general tendency. We draw a violin plot and see that, in general, there is a trend to have more observations without [n] among older speakers and with [n] among younger ones. But we must be careful because this kind of visualization does not take into account how many utterances alltogether there are in the interview from one speaker. It might display not the tendency but the disproportionality of the collected data.

```{r}
df %>%
  ggplot(aes(consonant, year, fill = consonant, color = consonant)) +
  geom_violin(show.legend = FALSE) +
  labs(title = "Correlation between the year of birth and the absence / presence of [n]", x = "Initial [n]", y = "Year of birth") +
  theme_bw()
```

Therefore, let us draw a scatter plot considering each speaker separately in order to check the correlation between the year of birth and the empirical proportion of observations with [n]. As these are only observed proportions and not absolute measures, we also want to see and keep in mind what is the number of observations.

```{r}
df %>%
  group_by(year, speaker, education) %>%
  summarise(prop_consonant = sum(consonant == "yes")/(sum(consonant == "yes") + sum(consonant == "no")), all_consonant = (sum(consonant == "yes") + sum(consonant == "no"))) %>%
  ggplot(aes(year, prop_consonant, color = all_consonant, label = speaker)) +
  geom_text(nudge_y = 0.02, size = 3) +
  geom_point() +
  labs(title = "Proportion of 3rd person pronoun forms with initial [n]: different speakers", subtitle = "Correlation with the year of birth", x = "Year of birth", y = "Proportion of forms with initial [n]", color = "Number of observations") +
  theme_bw()
```

As we also suppose that education level might have an impact on the dialectal performance on the speakers, we need to visualize it first. Let us display the education level on our scatter plot. We can observe that it is probably not fully independent variable and depends on the year of birth. Therefore, in our analysis we should keep in mind the option to consider the integration of these variables.

```{r}
df %>%
  group_by(year, speaker, education) %>%
  summarise(prop_consonant = sum(consonant == "yes")/(sum(consonant == "yes") + sum(consonant == "no"))) %>%
  ggplot(aes(year, prop_consonant, colour = education, label = speaker)) +
  geom_text(nudge_y = 0.02, size = 3, show.legend = FALSE) +
  geom_point() +
  labs(title = "Proportion of 3rd person pronoun forms with initial [n]: different speakers", subtitle = "Correlation with the year of birth: with regard to the education level", x = "Year of birth", y = "Proportion of forms with initial [n]", color = "Education level") +
  theme_bw()
```

We also suppose the dependency on the gender, so let us display this variable on the scatter plot. Again, male speakers are mostly born in 1950-1970, so probably the sample is not perfect for the analysis and depends on the year. We chould check the correlation with the statistical methods.

```{r}
df %>%
  group_by(year, speaker, gender) %>%
  summarise(prop_consonant = sum(consonant == "yes")/(sum(consonant == "yes") + sum(consonant == "no"))) %>%
  ggplot(aes(year, prop_consonant, color = gender, label = speaker)) +
  geom_text(nudge_y = 0.02, size = 3, show.legend = FALSE) +
  geom_point() +
  labs(title = "Proportion of 3rd person pronoun forms with initial [n]: different speakers", subtitle = "Correlation with the year of birth: with regard to the gender", x = "Year of birth", y = "Proportion of forms with initial [n]", color = "Gender") +
  theme_bw()
```

First, we want to check whether the linear regression model is good for our data. In order to do that, we should transform our data frame into a shorter format, so that each observation is not a pronoun with preposition but a speaker with a certain number or dialectal `dial` (without [n]) and innovative `inn` (with [n]) pronunciations. Then we plot our linear regression with the predictor `year`.

```{r}
df %>%
  group_by(speaker, year, gender, education) %>%
  summarise(dial = sum(consonant=="no"), inn = sum(consonant=="yes")) ->
  num_df
num_df %>%
  mutate(perc = inn/(dial + inn)) %>%
  ggplot(aes(year, perc))+
  geom_point()+
  geom_smooth(method = "lm") +
  labs(title = "Proportion of 3rd person pronoun forms with initial [n]: different speakers", subtitle = "Correlation with the year of birth: linear regression", x = "Year of birth", y = "Proportion of forms with initial [n]") +
  theme_bw()
```

After plotting the linear regression we see two major problems: 1. It is not good, because it does not cover all the variability (or the big part of it); 2. It predicts values above 1 and less than 0, which is impossible, because a speaker cannot pronounce less than 0 per cent and more then 100 per cent. Therefore, we need to consider our data as the one with binary dependent variable. Only in this case the model will be able to give us realistic results. 

## Logistic Regression Model
The data set analyzed in our research consists of binary variables, where only two outcomes are possible: variable `consonant` with the value `no` (the absence of initial [n]) and with the value `yes` (the presence of initial [n]). Therefore, the calculations were made with the help of Logit. The Logistic Regression Model has advantages for our data. First, predicted values are always between 0 and 1. It means that predicted proportions won’t be above 1 or below 0, which is impossible in our context. Second, in comparison to simple proportions, this method allows to weight the amount of contributions in each case (the number of occurrences for every informant). This is very important in case of data like ours, because some speakers have extremely low number of outcomes. In R, logits can be easily calculated with the function `glm()` (i.e. Generalized Linear Model). The hypotheses that we are going to check with the help of logistic regression model are:

* H0: There is no correlation between `consonant` and the predictors (independent variables and their interactions).
* H1: There is a correlation between `consonant` and the predictors (independent variables and their interactions).


First, let us consider a simple model with the numerical variable `year` as a predictor. Then we can visulize it and compare with the previuos results.

```{r}
fit_year <- glm(consonant~year, data = df, family = "binomial")
summary(fit_year)
```

As a result, the estimate coefficient, that shows dependence on predictor `year`, equals to `1.052e-01`, and is positive, which means that the later the informants were born the higher is the probability that they give innovative responses with [n]. The significance code mentioned in the model is `***`, the dependence is considered to be significant, i.e. the coefficient rate cannot be explained by randomness. Let us plot the sigmoid for this logistic regression, together with confidence intervals.

```{r}
df_ci <- cbind.data.frame(df, predict(fit_year, df, type = "response", se.fit = TRUE)[1:2])
df_ci %>%
  mutate(`P(consonant)` = as.numeric(consonant) - 1) %>% 
  ggplot(aes(x = year, y = `P(consonant)`))+
  geom_smooth(method = "glm", method.args = list(family = "binomial"), se = FALSE)+
  geom_point() +
  geom_pointrange(aes(x = year, ymin = fit - se.fit, ymax = fit + se.fit))+
  labs(title = "Logistic regression: initial [n] ~ year of birth", subtitle = "Separate observations. Confidence intervals", x = "Year of birth", y = "Proportion of forms with initial [n]") +
  theme_bw()
```

The plot in shape of S curve predicts the distribution of probability of variable value [n] among speakers of different year of birth. Unfortunately, this plot does not tell us much about how well this  sigmoid displays the actual perdormance of each speaker. Moreover, confidence intervals do not provide us with much information. We need to plot the observed probabilities besides the sigmoid with the predicted ones (first, create a data frame with probabilities `df_probs`, then join it with the regular data frame and then plot separate points for the observed probabilities).

```{r}
df %>%
  group_by(year, speaker, education) %>%
  summarise(prop_consonant = sum(consonant == "yes")/(sum(consonant == "yes") + sum(consonant == "no"))) ->
  df_probs
df <- inner_join(df, df_probs)
df %>%
  mutate(`P(consonant)` = as.numeric(consonant) - 1) %>% 
  ggplot(aes(x = year, y = `P(consonant)`))+
  geom_smooth(method = "glm", method.args = list(family = "binomial"), se = FALSE)+
  geom_point(aes(x = year, y = prop_consonant)) +
  labs(title = "Logistic regression: initial [n] ~ year of birth", subtitle = "Observed probabilities for each speaker", x = "Year of birth", y = "Proportion of forms with initial [n]") +
  theme_bw()
```

After we drew a plot for the numerical predictor, let us see what are the predictions of the model with all possible predictors:

```{r}
fit_all <- glm(consonant ~ year + education + gender + prep_type + prep_frequency + case + form, data = df, family = "binomial")
summary(fit_all)
```

The first thing that we can observe is that predictors `prep_type`, `case` and `prep_frequency` are not significant for out model (according to the significance code). But male `form` of the pronoun changes the log odds of initial [n] by `-0.82600`. Both `year` and `gender` are statistically significant, as is one term for `education` (`educationhigh-mid`):

*	For every one unit change in `year`, the log odds of initial [n] (versus its absence) increases by `0.14078`.
*	Being a `male` versus `female` changes the log odds of initial [n] by `-0.82000`.
*	Having the `education` of the level `high-mid` versus the level `high`, changes the log odds of initial [n] by `-1.23655`.

After applying the Anova test, we also see that the strongest predictor is the year of birth `year`: it allows to get rid of the biggest amount of deviance. On the contrary, `prep_type`, `case` and `prep_frequency` are almost unsignificant. This means that the preposition probably has no influence on the absence or presence of the initial [n].

```{r}
anova(fit_all, test="Chisq")
```

Therefore, we can remove predictors `prep_type`, `case` and `prep_frequency` from our model. Model `fit4` is the model only with significant predictors. Its `AIC` is `885.59`.

```{r}
fit4 <- glm(consonant ~ year + education + gender + form, data = df, family = "binomial")
summary(fit4)

```

As a next step we need to create a table to look and the predicted probabilities of this model for different values of independent variables.

```{r}
df %>% 
  count(year, education, gender, form, consonant) %>% 
  select(-n, -consonant) %>% 
  unique() ->
  fit_prob_df
fit_prob_df %>% 
  predict(fit4, newdata = ., type = "response") -> 
  fit_prob_df$prediction
fit_prob_df %>% 
  arrange(prediction)
fit_prob_df %>% 
  arrange(desc(prediction))
```

As we see, the lowest probability of initial [n] `0.01613983` is for the male pronoun in the speech of female informant 1928 year of birth and high-mid education level. The highest `0.9994919` for the female pronoun in the speech of female informant 1996 year of birth and high education level. This data is hardly interpetable because we mix socolinguitic predictors and observation-characteristic predictor. For this table, let us consider solely sociolinguitic factors (to understand something about the speakers of the dialect).

```{r}
df %>% 
  count(year, education, gender, consonant) %>% 
  select(-n, -consonant) %>% 
  unique() ->
  proba_df
fit_socio <- glm(consonant ~ year + education + gender, data = df, family = "binomial")
proba_df %>% 
  predict(fit_socio, newdata = ., type = "response") -> 
  proba_df$prediction
proba_df %>% 
  arrange(prediction)
proba_df %>% 
  arrange(desc(prediction))
```

This provides us only with the important information . Now we can say what are the characteristics of the most and the least dialectal informant (not depending on the pronoun): the lowest probability of [n] outcome `0.02796769` is for the the female speaker 1928 year of birth and high-mid education level and the highest `0.9989835` for the the female speaker 1996 year of birth and high education level (the same as in th previous table).

However, before removing the variable `case`, let us try to look at its integration with the variable `form` because they both constitute the output form of a pronoun (i.e. case and gender). The problem with this model is that it is too complicated.

```{r}
fit5 <- glm(consonant ~ year + education + gender + case*form, data = df, family = "binomial")
anova(fit4, fit5)
```

We see that we probably should not fully remove the predictor `case` but consider it in the integration with `form`. Moreover, we want to check the integration of `year`, `education` and `gender`, because they constitute the group of sociolinguistic factors and may influence each other.

```{r}
fit6 <- glm(consonant ~ year * education + gender + case*form, data = df, family = "binomial")
fit_final <- glm(consonant ~ year * education * gender + case*form, data = df, family = "binomial")
anova(fit5, fit6)
anova(fit6, fit_final)
```

We can observe that the model with integration of all sociolinguistic factors covers more variability than the simple additive model. The AIC (`753.33`) is the lowest for this model in comparison to the other presented fits. This is going to be our final model (`fit_final`).

```{r}
summary(fit_final)
```


## Summary
Even on our simple descriptive scatter plots we could see that there might be some correlation between the proportion of the observations with the initial [n] in the forms of third person pronouns in prepositional constructions and year. We also could suppose that education level and gender may influence this variable. We showed that linear regression model does not fit to the data like this: altough all speakers have their own degree  of being dialectal, we must keep considering the data as having binary dependent variable. After trying different possible models we came to the following results. The simplest and, nonetheless, quite strong, model is with the sole predictor `year` year of birth (it explains the most number of variability). We also can add other predictors, which, however, complicate the model and each of them is less significant. One more important result is the observation that, apparently, the preposition (its type and frequency) has no impact on the choice of the form.

## Sources
* Baayen R.H. (2008). *Analyzing Linguistic Data: a Practical Introduction to Statistics Using R*. Cambridge University Press.
* Daniel M., Dobrushina N., von Waldenfels R.. *The language of the Ustja river bassin. A corpus of North Russian dialectal speech*. 2013-2014. Bern, Moscow. Electronic resource.
* Gries, St. Th. (2013). *Statistics for Linguistics with R: A Practical Introduction*. 2nd ed. Mouton de Gruyter.
* von Waldenfels R., Daniel M., Dobrushina N. (2014). *Why Standard Orthography? Building the Ustya River Basin Corpus, an online corpus of a Russian dialect*. Computational Linguistics and Intellectual Technologies: Proceedings of the International Conference “Dialogue 2014” [Komp’yuternaya Lingvistika i Intellektual’nye Tekhnologii: Po materialam ezhegodnoy Mezhdunarodnoy Konferentsii «Dialog 2014»], Bekasovo, Vyp. 13 (20). 
* Zhigulskaya V.R. (2015). *A variation study of third person pronouns in prepositional constructions: a North Russian Dialect*. Paper presented at the The International Conference on Language Variation in Europe (ICLaVE) 8, Leipzig, Germany, 2015, May.
